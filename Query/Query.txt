CREATE DATABASE Project;
USE Project;


CREATE USER 'Admin'@'localhost' IDENTIFIED BY 'password';
GRANT ALL PRIVILEGES ON *.* TO 'Admin'@'localhost' WITH GRANT OPTION;

CREATE USER 'Dean'@'localhost' IDENTIFIED BY 'password';
GRANT ALL PRIVILEGES ON Project.* TO 'Dean'@'localhost';

CREATE USER 'Lecturer'@'localhost' IDENTIFIED BY 'password';
GRANT ALL PRIVILEGES ON Project.* TO 'Lecturer'@'localhost';

CREATE USER 'Technical_officer'@'localhost' IDENTIFIED BY 'password';
GRANT SELECT, INSERT, UPDATE ON Project.* TO 'Technical_officer'@'localhost';



#################################           Faculty Table

CREATE TABLE faculty(Fac_id VARCHAR(5) PRIMARY KEY,
Fac_name VARCHAR(30) NOT NULL,
Dean VARCHAR(10));

INSERT INTO faculty(Fac_id,Fac_name,Dean) VALUES('FAC07','Faculty of Technology','EMP0043');




###############################             DEPARTMENT Table

CREATE TABLE Department(Dep_id VARCHAR(5) PRIMARY KEY,
Dep_name VARCHAR(20) NOT NULL,
HOD VARCHAR(10) NOT NULL,
Fac_id VARCHAR(5) NOT NULL,
FOREIGN KEY(Fac_id) REFERENCES faculty(Fac_id) ON DELETE CASCADE);

INSERT INTO department(Dep_id,Dep_name,HOD,Fac_id) VALUES
('ICT','Information and Communication Technology','EMP0101','FAC07'),
('BST','Bio System Technology','EMP0110','FAC07'),
('ET','Engineering Technology','EMP0121','FAC07');  




####################################            ACEDEMIC STAFF

CREATE TABLE academic_staff(Staff_id VARCHAR(10) PRIMARY KEY,
F_name VARCHAR(20) NOT NULL,
L_name VARCHAR(20) NOT NULL,
NIC_number VARCHAR(15) NOT NULL,
Appoint_date DATE NOT NULL,
Address VARCHAR(40),
Gender ENUM('Male','Female') NOT NULL,
Status ENUM('Working','Not_Working') DEFAULT 'Working',
Fac_id VARCHAR(5) NOT NULL,
FOREIGN KEY(Fac_id) REFERENCES faculty(Fac_id) ON DELETE CASCADE);

INSERT INTO academic_staff(Staff_id,F_name,L_name,NIC_number,Appoint_date,Address,Gender,Fac_id) VALUES
('EMP0110', 'Chamari', 'Abeykoon', '742345678V', '2010-03-15', 'No. 12, Lake Road, Kandy', 'Female','FAC07'),
('EMP0121', 'Dilani', 'Senanayake', '682345678V', '2008-07-22', '45/3, Temple Lane, Galle', 'Female','FAC07'),
('EMP0101', 'Dinesh', 'Wickramasinghe', '792345678V', '2010-12-03', '19, Riverside Lane, Hambantota', 'Male','FAC07'),
('EMP0111', 'Malsha', 'Wijesinghe', '752345678V', '2012-01-10', '88, Rose Garden, Matara', 'Female','FAC07'),
('EMP0112', 'Ruwanthi', 'De Silva', '198412345678', '2015-06-05', '23, Palm Street, Colombo 07', 'Female','FAC07'),
('EMP0102', 'Ishara', 'Fernando', '812345678V', '2011-09-18', '17, Ocean View, Negombo', 'Female','FAC07'),
('EMP0043', 'Nuwan', 'Perera', '197845678901', '2009-02-12', '10, Hill Crest, Kurunegala', 'Male','FAC07'),
('EMP0113', 'Tharindu', 'Jayasinghe', '198212345678', '2013-11-30', '56, Lotus Avenue, Anuradhapura', 'Male','FAC07'),
('EMP0114', 'Kasun', 'Rathnayake', '198512345678', '2014-08-25', '34, Sunrise Road, Badulla', 'Male','FAC07'),
('EMP0115', 'Tharindu', 'Jayasinghe', '198212345678', '2013-11-30', '56, Lotus Avenue, Anuradhapura', 'Male','FAC07'),
('EMP0116', 'Dilani', 'Senanayake', '682345678V', '2008-07-22', '45/3, Temple Lane, Galle', 'Female','FAC07'),
('EMP0117', 'Sanjeewa', 'Gunawardena', '197912345678', '2007-04-19', '78, Green Park, Nuwara Eliya', 'Male','FAC07'),
('EMP0118', 'Malsha', 'Wijesinghe', '752345678V', '2009-01-10', '88, Rose Garden, Matara', 'Female','FAC07'),
('EMP0119', 'Dinesh', 'Wickramasinghe', '792345678V', '2008-12-03', '19, Riverside Lane, Hambantota', 'Male','FAC07');




CREATE TABLE faculty(Fac_id VARCHAR(5) PRIMARY KEY,
Fac_name VARCHAR(30) NOT NULL,
Dean VARCHAR(10));

INSERT INTO faculty(Fac_id,Fac_name,Dean) VALUES('FAC07','Faculty of Technology','EMP0043');


CREATE TABLE Department(Dep_id VARCHAR(5) PRIMARY KEY,
Dep_name VARCHAR(20) NOT NULL,
HOD VARCHAR(10) NOT NULL,
Fac_id VARCHAR(5) NOT NULL,
FOREIGN KEY(Fac_id) REFERENCES faculty(Fac_id) ON DELETE CASCADE);

INSERT INTO department(Dep_id,Dep_name,HOD,Fac_id) VALUES
('ICT','Information and Communication Technology','EMP0101','FAC07'),
('BST','Bio System Technology','EMP0110','FAC07'),
('ET','Engineering Technology','EMP0121','FAC07');  -- FIXED: "Engneering" â†’ "Engineering"


CREATE TABLE academic_staff(Staff_id VARCHAR(10) PRIMARY KEY,
F_name VARCHAR(20) NOT NULL,
L_name VARCHAR(20) NOT NULL,
NIC_number VARCHAR(15) NOT NULL,
Appoint_date DATE NOT NULL,
Address VARCHAR(40),
Gender ENUM('Male','Female') NOT NULL,
Status ENUM('Working','Not_Working') DEFAULT 'Working',
Fac_id VARCHAR(5) NOT NULL,
FOREIGN KEY(Fac_id) REFERENCES faculty(Fac_id) ON DELETE CASCADE);

INSERT INTO academic_staff(Staff_id,F_name,L_name,NIC_number,Appoint_date,Address,Gender,Fac_id) VALUES
('EMP0110', 'Chamari', 'Abeykoon', '742345678V', '2010-03-15', 'No. 12, Lake Road, Kandy', 'Female','FAC07'),
('EMP0121', 'Dilani', 'Senanayake', '682345678V', '2008-07-22', '45/3, Temple Lane, Galle', 'Female','FAC07'),
('EMP0101', 'Dinesh', 'Wickramasinghe', '792345678V', '2010-12-03', '19, Riverside Lane, Hambantota', 'Male','FAC07'),
('EMP0111', 'Malsha', 'Wijesinghe', '752345678V', '2012-01-10', '88, Rose Garden, Matara', 'Female','FAC07'),
('EMP0112', 'Ruwanthi', 'De Silva', '198412345678', '2015-06-05', '23, Palm Street, Colombo 07', 'Female','FAC07'),
('EMP0102', 'Ishara', 'Fernando', '812345678V', '2011-09-18', '17, Ocean View, Negombo', 'Female','FAC07'),
('EMP0043', 'Nuwan', 'Perera', '197845678901', '2009-02-12', '10, Hill Crest, Kurunegala', 'Male','FAC07'),
('EMP0113', 'Tharindu', 'Jayasinghe', '198212345678', '2013-11-30', '56, Lotus Avenue, Anuradhapura', 'Male','FAC07'),
('EMP0114', 'Kasun', 'Rathnayake', '198512345678', '2014-08-25', '34, Sunrise Road, Badulla', 'Male','FAC07'),
('EMP0115', 'Tharindu', 'Jayasinghe', '198212345678', '2013-11-30', '56, Lotus Avenue, Anuradhapura', 'Male','FAC07'),
('EMP0116', 'Dilani', 'Senanayake', '682345678V', '2008-07-22', '45/3, Temple Lane, Galle', 'Female','FAC07'),
('EMP0117', 'Sanjeewa', 'Gunawardena', '197912345678', '2007-04-19', '78, Green Park, Nuwara Eliya', 'Male','FAC07'),
('EMP0118', 'Malsha', 'Wijesinghe', '752345678V', '2009-01-10', '88, Rose Garden, Matara', 'Female','FAC07'),
('EMP0119', 'Dinesh', 'Wickramasinghe', '792345678V', '2008-12-03', '19, Riverside Lane, Hambantota', 'Male','FAC07');
CREATE TABLE Ac_staff_contuct(Contuct_id INT PRIMARY KEY AUTO_INCREMENT,
Staff_id VARCHAR(10),
Phone_number VARCHAR(13) NOT NULL,
FOREIGN KEY (Staff_id) REFERENCES Academic_staff(Staff_id) ON DELETE CASCADE);


INSERT INTO Ac_staff_contuct(Staff_id,Phone_number) VALUES
('EMP0110', '077-4567890'),
('EMP0110', '071-2345678'),
('EMP0121', '075-1122334'),
('EMP0121', '076-9988776'),
('EMP0101', '078-5566778'),
('EMP0111', '072-4433221'),
('EMP0111', '077-8899001'),
('EMP0112', '071-2233445'),
('EMP0102', '075-3344556'),
('EMP0043', '076-7788990'),
('EMP0043', '078-9900112'),
('EMP0113', '070-6655443'),
('EMP0113', '072-9988776'),
('EMP0114', '074-1122334'),
('EMP0115', '071-3344556'),
('EMP0116', '075-7788990'),
('EMP0117', '076-9900112'),
('EMP0117', '077-2233445'),
('EMP0119', '078-4433221');


CREATE TABLE Ac_staff_degree(Id INT PRIMARY KEY AUTO_INCREMENT,
Staff_id VARCHAR(10) NOT NULL,
Degree VARCHAR(40) NOT NULL,
FOREIGN KEY (Staff_id) REFERENCES Academic_staff(Staff_id) ON DELETE CASCADE);

INSERT INTO Ac_staff_degree(Staff_id,Degree) VALUES
('EMP0110', 'BSc in Biological Science'),
('EMP0110', 'MSc in Biotechnology'),
('EMP0121', 'BEng in Electrical Engineering'),
('EMP0101', 'BSc in Information Technology'),
('EMP0101', 'MSc in Computer Networks'),
('EMP0102', 'BSc in Computer Science'),
('EMP0102', 'PhD in Artificial Intelligence'),
('EMP0102', 'Diploma in Data Analytics'),
('EMP0111', 'BSc in Software Engineering'),
('EMP0111', 'MSc in Data Science'),
('EMP0112', 'BSc in Computer Applications'),
('EMP0113', 'BSc in Information Technology'),
('EMP0113', 'MPhil in Cyber Security'),
('EMP0114', 'BSc in Multimedia Technology'),
('EMP0114', 'MBA in Technology Management'),
('EMP0115', 'BSc in Information Systems'),
('EMP0115', 'MSc in Information Technology'),
('EMP0115', 'PhD in Computer Engineering'),
('EMP0116', 'BSc in Information Technology'),
('EMP0116', 'MSc in Computer Networks'),
('EMP0117', 'BSc in Software Engineering'),
('EMP0118', 'BSc in Computer Science'),
('EMP0118', 'MSc in Information Security'),
('EMP0119', 'BSc in Data Science'),
('EMP0119', 'Diploma in Web Development');


CREATE TABLE Lecturer(Lec_id VARCHAR(10) PRIMARY KEY,
Type ENUM('Assistant lecturer','Lecturer','Senior lecturer') NOT NULL,
Dep_id VARCHAR(5) NOT NULL,
FOREIGN KEY(Lec_id) REFERENCES Academic_staff(Staff_id),
FOREIGN KEY(Dep_id) REFERENCES Department(Dep_id));

INSERT INTO Lecturer(Lec_id,Type,Dep_id) VALUES
('EMP0110','Senior lecturer','BST'),
('EMP0121','Senior lecturer','ET'),
('EMP0101','Senior lecturer','ICT'),
('EMP0102','Lecturer','ICT'),
('EMP0111','Lecturer','ICT'),
('EMP0112','Lecturer','ICT'),
('EMP0113','Lecturer','ICT'),
('EMP0114','Lecturer','ICT'),
('EMP0115','Lecturer','ICT');


CREATE TABLE Dean(Dean_id VARCHAR(10) PRIMARY KEY,
Appoint_date DATE NOT NULL,
End_date DATE,
FOREIGN KEY (Dean_id) REFERENCES Academic_staff(Staff_id));

INSERT INTO Dean(Dean_id,Appoint_date) VALUES ('EMP0043','2009-02-12');


CREATE TABLE Demo(Dem_id VARCHAR(10) PRIMARY KEY,
Type ENUM('Temporary','Permanant'),
Dep_id VARCHAR(5),
FOREIGN KEY (Dem_id) REFERENCES Academic_staff(Staff_id),
FOREIGN KEY (Dep_id) REFERENCES Department(Dep_id));

INSERT INTO Demo(Dem_id,Type,Dep_id) VALUES
('EMP0116','Temporary','ICT'),      -- FIXED: Added missing comma
('EMP0117','Permanant','ICT'),
('EMP0118','Permanant','ICT'),
('EMP0119','Permanant','ICT');


CREATE TABLE Course(Course_id VARCHAR(5) PRIMARY KEY,
Course_name VARCHAR(50) NOT NULL,
Total_credits INT NOT NULL,
Dep_id VARCHAR(5) NOT NULL,
FOREIGN KEY(Dep_id) REFERENCES Department(Dep_id));

INSERT INTO Course(Course_id,Course_name,Total_credits,Dep_id) VALUES
('BICT','Bachelor of Information Communication Technology',120,'ICT'),  
('BST','Bachelor of Biosystem Technology',120,'BST'),                   
('BET','Bachelor of Engineering Technology',120,'ET');                  


CREATE TABLE Student(Reg_no VARCHAR(12) PRIMARY KEY,
F_name VARCHAR(30) NOT NULL,
L_name VARCHAR(30) NOT NULL,
NIC VARCHAR(12) NOT NULL,
Batch VARCHAR(10),
Address VARCHAR(50),
Gender ENUM('Male','Female') NOT NULL,
E_mail VARCHAR(30),
DOB DATE,
Course_id VARCHAR(5) NOT NULL,
Dep_id VARCHAR(5) NOT NULL,
FOREIGN KEY(Course_id) REFERENCES Course(Course_id) ON DELETE CASCADE,
FOREIGN KEY(Dep_id) REFERENCES Department(Dep_id) ON DELETE CASCADE);




INSERT INTO Subject (Sub_code, Sub_name, Credit, Total_hours, Course_id, Lec_id) VALUES
('ENG1222', 'English II', 2, 30, 'BICT','EMP0111'),
('ICT1212', 'Database Management Systems', 2, 30, 'BICT', 'EMP0112'),
('ICT1222', 'Database Management Systems Practicum', 2, 30, 'BICT', 'EMP0112'),
('ICT1233', 'Server-Side Web Development', 3, 60, 'BICT', 'EMP0113'),
('ICT1242', 'Computer Architecture', 2, 60, 'BICT', 'EMP0114'),
('ICT1253', 'Computer Networks', 3, 60, 'BICT', 'EMP0115'),
('TCS1212', 'Fundamentals of Management', 2, 60, 'BICT','EMP0102'), 
('TCS1233', 'Discrete Mathematics', 3, 60, 'BICT', 'EMP0117');




CREATE TABLE Course_Subject (
    Course_id VARCHAR(5),          
    Sub_code VARCHAR(10),
    PRIMARY KEY (Course_id, Sub_code),
    FOREIGN KEY (Course_id) REFERENCES Course(Course_id),     
    FOREIGN KEY (Sub_code) REFERENCES Subject(Sub_code)
);

INSERT INTO Course_Subject (Course_id, Sub_code) VALUES      
('BICT', 'ENG1222'),  
('BICT', 'ICT1212'),
('BICT', 'ICT1222'),
('BICT', 'ICT1233'),
('BICT', 'ICT1242'),
('BICT', 'ICT1253'),
('BICT', 'TCS1212'),
('BICT', 'TCS1233');
('EMP0116','Temporary','ICT'),     
('EMP0117','Permanant','ICT'),
('EMP0118','Permanant','ICT'),
('EMP0119','Permanant','ICT');



#########################################      NONACEDEMIC STAFF

CREATE TABLE Non_academic_staff(Nac_staff_id VARCHAR(10) PRIMARY KEY,
	 F_name VARCHAR(25) NOT NULL,
	 L_name VARCHAR(25) NOT NULL,
	 Gender ENUM('Male','Female') NOT NULL,
	 Address VARCHAR(60),
	 NIC_number VARCHAR(15) NOT NULL,
	 E_mail VARCHAR(30),
	 Status ENUM('Working','Not_Working') DEFAULT 'Working',
	 Appoint_date DATE NOT NULL,
	 Fac_id VARCHAR(5) NOT NULL,
	 FOREIGN KEY(Fac_id) REFERENCES faculty(Fac_id) ON DELETE CASCADE ON UPDATE CASCADE
	 );
	 
	 CREATE TABLE NAC_staff_CONTACT(
	      Nac_staff_id VARCHAR(10),
		  Contact_no CHAR(10),
		  PRIMARY KEY(Nac_staff_id, Contact_no),
		  FOREIGN KEY(Nac_staff_id) REFERENCES Non_academic_staff(Nac_staff_id)
		  );
		  
	 
	 CREATE TABLE Security(
	     Sec_id VARCHAR(10) PRIMARY KEY,
		 Work_shift ENUM('Day','Night') DEFAULT 'Day',
		 Duty_area VARCHAR(30),
		 FOREIGN KEY(Sec_id) REFERENCES Non_academic_staff(Nac_staff_id)
		 );
		 
		
	CREATE TABLE Cleaner(
	     Cleaner_id VARCHAR(10) PRIMARY KEY,
		 Work_shift ENUM('Morning','Evening'),
		 Assigned_area VARCHAR(30),
		 FOREIGN KEY(Cleaner_id) REFERENCES Non_academic_staff(Nac_staff_id)
		 );
		 
		 
	CREATE TABLE Administrator(
	   AD_id VARCHAR(10) PRIMARY KEY,
	   Office_room_no VARCHAR(10),
	   FOREIGN KEY(AD_id) REFERENCES Non_academic_staff(Nac_staff_id)
	   );
	   
	   
	CREATE TABLE Tech_officer(
	   TO_id VARCHAR(10) PRIMARY KEY,
	   Lab_assigned VARCHAR(25),
	   FOREIGN KEY(TO_id) REFERENCES Non_academic_staff(Nac_staff_id)
	   );
	   
	   
		 
		 
	INSERT INTO Non_academic_staff (Nac_staff_id, F_name, L_name, Gender, Address, NIC_number, E_mail, Status, Appoint_date, Fac_id)
     VALUES
    ('NAC001','Sunil','Perera','Male','No.12,Main Street,Galle','931234567V','sunil.perera@uni.lk','Working','1993-03-21','FAC07'),
    ('NAC002','Kamal','Fernando','Male','No.45,Temple Road,Matara','902345678V','kamal.fernando@uni.lk','Working','1990-06-12','FAC07'),
    ('NAC003','Nimali','Silva','Female','No.10,Station Road,Kandy','952134567V','nimali.silva@uni.lk','Not_Working','1995-01-10','FAC07'),
    ('NAC004','Ruwan','Jayasinghe','Male','No.32,Lake View,Colombo','881245678V','ruwan.j@uni.lk','Working','2012-09-14','FAC07'),
    ('NAC005','Dilani','Weerasinghe','Female','No.55,Hill Street,Kurunegala','972346578V','dilani.w@uni.lk','Working','2020-02-05','FAC07'),
    ('NAC006','Roshan','Abeywickrama','Male','No.8,New Road,Hambantota','911234589V','roshan.a@uni.lk','Working','2016-07-28','FAC07'),
    ('NAC007','Shanika','Perera','Female','No.76,Galle Road,Panadura','993456781V','shanika.p@uni.lk','Not_Working','2021-03-11','FAC07');


   INSERT INTO NAC_staff_CONTACT (Nac_staff_id, Contact_no) 
   VALUES
     ('NAC001', '0712345678'),
     ('NAC001', '0779876543'),
     ('NAC002', '0723456789'),
     ('NAC003', '0719876543'),
     ('NAC004', '0751234567'),
     ('NAC004', '0771234567');


		 
	INSERT INTO Security (Sec_id, Work_shift, Duty_area) 
	VALUES
    ('NAC001', 'Day', 'Main Gate'),
    ('NAC004', 'Night', 'Laboratory Area');

	 
	INSERT INTO Cleaner (Cleaner_id, Work_shift, Assigned_area) 
	VALUES
    ('NAC005', 'Morning', 'Lecture Hall'),
    ('NAC002', 'Evening', 'Laboratory Area');
	
	INSERT INTO Administrator (AD_id, Office_room_no) 
	VALUES
     ('NAC003', 'A101');
	 
	 
	INSERT INTO Tech_officer (TO_id,Lab_assigned) 
	VALUES
    ('NAC006','Computer Lab'),
    ('NAC007','Electronics Lab');

	 
	 
	 


#########################################             SUBJECT TABLE
	 

CREATE TABLE Subject (Sub_code VARCHAR(10) PRIMARY KEY,
    Sub_name VARCHAR(100) NOT NULL,
    Credit INT,
    Total_hours INT
);

INSERT INTO Subject (Sub_code, Sub_name, Credit, Total_hours, Course_id, Lec_id) VALUES
('ENG1222', 'English II', 2, 30, 'BICT','EMP0111'),
('ICT1212', 'Database Management Systems', 2, 30, 'BICT', 'EMP0112'),
('ICT1222', 'Database Management Systems Practicum', 2, 30, 'BICT', 'EMP0112'),
('ICT1233', 'Server-Side Web Development', 3, 60, 'BICT', 'EMP0113'),
('ICT1242', 'Computer Architecture', 2, 60, 'BICT', 'EMP0114'),
('ICT1253', 'Computer Networks', 3, 60, 'BICT', 'EMP0115'),
('TCS1212', 'Fundamentals of Management', 2, 60, 'BICT','EMP0102'), 
('TCS1233', 'Discrete Mathematics', 3, 60, 'BICT', 'EMP0117');




CREATE TABLE Exam (Exam_code VARCHAR(10) PRIMARY KEY,
    Exam_name VARCHAR(100) NOT NULL,
    Hour INT,
    Credit INT,
    Sub_code VARCHAR(10),
    FOREIGN KEY (Sub_code) REFERENCES Subject(Sub_code)
);


CREATE TABLE End_Theory (
    Exam_code VARCHAR(10) PRIMARY KEY,
    Date DATE,
    Location VARCHAR(30),
    FOREIGN KEY (Exam_code) REFERENCES Exam(Exam_code) ON DELETE CASCADE
);

INSERT INTO End_Theory (Exam_code, Date, Location) VALUES
('EX004', '2025-08-20', 'Main Hall');



CREATE TABLE End_Practical (
    Exam_code VARCHAR(10) PRIMARY KEY,
    Date DATE,
    Location VARCHAR(30),
    FOREIGN KEY (Exam_code) REFERENCES Exam(Exam_code) ON DELETE CASCADE
);

INSERT INTO End_Practical (Exam_code, Date, Location) VALUES
('EX005', '2025-08-22', 'Database Lab');



CREATE TABLE Mid_Theory (
    Exam_code VARCHAR(10) PRIMARY KEY,
    Date DATE,
    Location VARCHAR(30),
    FOREIGN KEY (Exam_code) REFERENCES Exam(Exam_code) ON DELETE CASCADE
);

INSERT INTO Mid_Theory (Exam_code, Date, Location) VALUES
('EX002', '2025-05-15', 'NBSLT');



CREATE TABLE Mid_Practical (
    Exam_code VARCHAR(10) PRIMARY KEY,
    Date DATE,
    Location VARCHAR(30),
    FOREIGN KEY (Exam_code) REFERENCES Exam(Exam_code) ON DELETE CASCADE
);

INSERT INTO Mid_Practical (Exam_code, Date, Location) VALUES
('EX003', '2025-05-10', 'NLBT');



CREATE TABLE Quiz (
    Exam_code VARCHAR(10) PRIMARY KEY,
    Date DATE,
    Location VARCHAR(30),
    FOREIGN KEY (Exam_code) REFERENCES Exam(Exam_code) ON DELETE CASCADE
);

INSERT INTO Quiz (Exam_code, Date, Location) VALUES
('EX006', '2025-05-06', 'NLBT'),
('EX007', '2025-05-16', 'NLBT'),
('EX008', '2025-05-26', 'NLBT');


CREATE TABLE Assessment (
    Exam_code VARCHAR(10) PRIMARY KEY,
    Date DATE,
    Location VARCHAR(30),
    FOREIGN KEY (Exam_code) REFERENCES Exam(Exam_code) ON DELETE CASCADE
);

INSERT INTO Assessment (Exam_code, Date, Location) VALUES
('EX009', '2025-05-15', 'NBSLT');





CREATE TABLE Course(Course_id VARCHAR(5) PRIMARY KEY,
Course_name VARCHAR(50) NOT NULL,
Total_credits INT NOT NULL,
Dep_id VARCHAR(5) NOT NULL,
FOREIGN KEY(Dep_id) REFERENCES Department(Dep_id));

INSERT INTO Course(Course_id,Course_name,Total_credits,Dep_id) VALUES
('BICT','Bachelor of Information Communication Technology',120,'ICT'),  
('BST','Bachelor of Biosystem Technology',120,'BST'),                   
('BET','Bachelor of Engineering Technology',120,'ET');                  


CREATE TABLE Student(Reg_no VARCHAR(12) PRIMARY KEY,
F_name VARCHAR(30) NOT NULL,
L_name VARCHAR(30) NOT NULL,
NIC VARCHAR(12) NOT NULL,
Batch VARCHAR(10),
Address VARCHAR(50),
Gender ENUM('Male','Female') NOT NULL,
E_mail VARCHAR(30),
DOB DATE,
Course_id VARCHAR(5) NOT NULL,
Dep_id VARCHAR(5) NOT NULL,
FOREIGN KEY(Course_id) REFERENCES Course(Course_id) ON DELETE CASCADE,
FOREIGN KEY(Dep_id) REFERENCES Department(Dep_id) ON DELETE CASCADE);



INSERT INTO Subject (Sub_code, Sub_name, Credit, Total_hours) VALUES
('ENG1222', 'English II', 2, 30),
('ICT1212', 'Database Management Systems', 2, 30),
('ICT1222', 'Database Management Systems Practicum', 2, 30),
('ICT1233', 'Server-Side Web Development', 3, 60),
('ICT1242', 'Computer Architecture', 2, 30),
('ICT1253', 'Computer Networks', 3, 60),
('TCS1212', 'Fundamentals of Management', 2, 30), 
('TCS1233', 'Discrete Mathematics', 3, 45);



CREATE TABLE Course_Subject (
Course_id VARCHAR(5),          
Sub_code VARCHAR(10),
PRIMARY KEY (Course_id, Sub_code),
FOREIGN KEY (Course_id) REFERENCES Course(Course_id),     
FOREIGN KEY (Sub_code) REFERENCES Subject(Sub_code)
);

INSERT INTO Course_Subject (Course_id, Sub_code) VALUES      
('BICT', 'ENG1222'),  
('BICT', 'ICT1212'),
('BICT', 'ICT1222'),
('BICT', 'ICT1233'),
('BICT', 'ICT1242'),
('BICT', 'ICT1253'),
('BICT', 'TCS1212'),
('BICT', 'TCS1233');


INSERT INTO Student(Reg_no,F_name,L_name,NIC,Batch,Address,Gender,E_mail,DOB,Course_id,Dep_id) VALUES
('TG/2023/1775','Nivethan','Rajkumar','200323311521','2022/2023','Main Street, Jaffna','Male','nivethan.rk@gmail.com','2003-07-15','BICT','ICT'),
('TG/2023/1776','Kavindya','Perera','200323311522','2022/2023','Lake View, Kandy','Female','kavindya.perera@gmail.com','2003-09-10','BICT','ICT'),
('TG/2023/1777','Tharindu','Senanayake','200323311523','2022/2023','Temple Road, Galle','Male','tharindu.sena@gmail.com','2003-06-25','BICT','ICT'),
('TG/2023/1778','Yalini','Sivakumar','200323311524','2022/2023','Beach Road, Trincomalee','Female','yalini.siva@gmail.com','2003-11-05','BICT','ICT'),
('TG/2023/1779','Ravindu','Fernando','200323311525','2022/2023','Hilltop Lane, Nuwara Eliya','Male','ravindu.fernando@gmail.com','2003-10-12','BICT','ICT'),
('TG/2023/1780','Sharanya','Kumar','200323311526','2022/2023','Market Street, Vavuniya','Female','sharanya.kumar@gmail.com','2003-08-30','BICT','ICT'),
('TG/2023/1781','Ishara','Jayasinghe','200323311527','2022/2023','Green Park, Colombo','Female','ishara.jaya@gmail.com','2003-05-18','BICT','ICT'),
('TG/2023/1782','Harshan','De Silva','200323311528','2022/2023','River Road, Matara','Male','harshan.desilva@gmail.com','2003-12-01','BICT','ICT'),
('TG/2023/1783','Nimesha','Wijesinghe','200323311529','2022/2023','Sunset Avenue, Kurunegala','Female','nimesha.wije@gmail.com','2003-04-22','BICT','ICT'),
('TG/2021/1452','Kishan','Tharmalingam','200123311420','2020/2021','Station Road, Batticaloa','Male','kishan.t2001@gmail.com','2001-06-14','BICT','ICT'),
('TG/2021/1453','Nadeesha','Gunawardena','200123311421','2020/2021','Palm Street, Gampaha','Female','nadeesha.guna@gmail.com','2001-09-22','BICT','ICT'),
('TG/2021/1454','Sutharsan','Mahendran','200123311422','2020/2021','Market Lane, Kilinochchi','Male','sutharsan.m2001@gmail.com','2001-12-03','BICT','ICT'),
('TG/2021/1455','Thushari','Rathnayake','200123311423','2020/2021','Hill Road, Badulla','Female','thushari.rathna@gmail.com','2001-08-17','BICT','ICT'),
('TG/2021/1456','Roshan','Jayawardena','200123311424','2020/2021','Riverbank, Anuradhapura','Male','roshan.jaya@gmail.com','2001-05-29','BICT','ICT'),
('TG/2023/1784','Dilshan','Abeysekara','200323311530','2022/2023','Tech Lane, Colombo','Male','dilshan.abey@gmail.com','2003-03-12','BET','ET'),
('TG/2023/1785','Vishaka','Sundaram','200323311531','2022/2023','University Road, Batticaloa','Female','vishaka.sundaram@gmail.com','2003-07-08','BST','BST'),
('TG/2023/1786','Ruwan','Edirisinghe','200323311532','2022/2023','Lake View, Kandy','Male','ruwan.ediri@gmail.com','2003-05-20','BET','BST'),
('TG/2023/1787','Anushka','Rajendran','200323311533','2022/2023','Main Street, Jaffna','Female','anushka.raj@gmail.com','2003-11-30','BST','ET'),
('TG/2023/1788','Kavindu','Silva','200323311534','2022/2023','Hilltop Avenue, Galle','Male','kavindu.silva@gmail.com','2003-09-14','BET','ET');






CREATE TABLE Course_Subject (Course_id VARCHAR(5),          
Sub_code VARCHAR(10),
PRIMARY KEY (Course_id, Sub_code),
FOREIGN KEY (Course_id) REFERENCES Course(Course_id),     
FOREIGN KEY (Sub_code) REFERENCES Subject(Sub_code)
);

INSERT INTO Course_Subject (Course_id, Sub_code) VALUES      
('BICT', 'ENG1222'),  
('BICT', 'ICT1212'),
('BICT', 'ICT1222'),
('BICT', 'ICT1233'),
('BICT', 'ICT1242'),
('BICT', 'ICT1253'),
('BICT', 'TCS1212'),
('BICT', 'TCS1233');





CREATE TABLE Medical(
Med_id VARCHAR(10) PRIMARY KEY,
Med_name VARCHAR(30),
Status ENUM('Approved','Not approved') DEFAULT 'Not approved',
Date_issued DATE,
Reason VARCHAR(60),
Reg_no VARCHAR(12),
FOREIGN KEY(Reg_no) REFERENCES Student(Reg_no) ON DELETE CASCADE ON UPDATE CASCADE
);
		 

<<<<<<< HEAD
=======
		 
<<<<<<< HEAD
>>>>>>> c423f58aec4132da74aec211d9551ff82c38a433
INSERT INTO Medical (Med_id, Med_name, Status, Date_issued, Reason, Reg_no) VALUES
('MED001','Flu Report','Approved','2025-03-12','Absent due to high fever','TG/2023/1775'),
('MED002','Injury Certificate','Approved','2025-05-04','Leg injury during sports','TG/2023/1780'),
('MED003','Medical Leave Form','Not Approved','2025-06-15','Late submission','TG/2021/1452'),
('MED004','Covid-19 Test Report','Approved','2025-02-22','Positive for COVID-19','TG/2023/1784'),
('MED005','Eye Infection Report','Not Approved','2025-07-10','Unclear medical document','TG/2023/1787');
 
 hi

<<<<<<< HEAD
		 

=======
=======
		 INSERT INTO Medical (Med_id, Med_name, Status, Date_issued, Reason, Reg_no) 
		 VALUES
              ('MED001','Flu Report','Approved','2025-03-12','Absent due to high fever','TG/2023/1775'),
              ('MED002','Injury Certificate','Approved','2025-05-04','Leg injury during sports','TG/2023/1780'),
              ('MED003','Medical Leave Form','Not Approved','2025-06-15','Late submission','TG/2021/1452'),
              ('MED004','Covid-19 Test Report','Approved','2025-02-22','Positive for COVID-19','TG/2023/1784'),
              ('MED005','Eye Infection Report','Not Approved','2025-07-10','Unclear medical document','TG/2023/1787');

-- Relatives of Academic Staff
CREATE TABLE Rel_academic(
    NIC VARCHAR(12) NOT NULL,
    Address VARCHAR(40),
    Rel_name VARCHAR(20),
    Gender ENUM('F', 'M'),
    Relationship VARCHAR(20),
    Staff_id VARCHAR(10) NOT NULL,
    PRIMARY KEY (NIC, Staff_id),
    FOREIGN KEY (Staff_id) REFERENCES academic_staff(Staff_id)
        ON UPDATE CASCADE
        ON DELETE CASCADE
);

-- Lecturer_Subject relation
CREATE TABLE Lecturer_Subject (
    Lec_id VARCHAR(10) NOT NULL,
    Sub_code VARCHAR(10) NOT NULL,
    PRIMARY KEY (Lec_id, Sub_code),
    FOREIGN KEY (Lec_id) REFERENCES Lecturer(Lec_id)
        ON UPDATE CASCADE
        ON DELETE CASCADE,
    FOREIGN KEY (Sub_code) REFERENCES Subject(Sub_code)
        ON UPDATE CASCADE
        ON DELETE CASCADE
);

-- Exam_Subject relation
CREATE TABLE Exam_Subject (
    Exam_code VARCHAR(10) NOT NULL,
    Sub_code VARCHAR(10) NOT NULL,
    PRIMARY KEY (Exam_code, Sub_code),
    FOREIGN KEY (Exam_code) REFERENCES Exam(Exam_code)
        ON UPDATE CASCADE
        ON DELETE CASCADE,
    FOREIGN KEY (Sub_code) REFERENCES Subject(Sub_code)
        ON UPDATE CASCADE
        ON DELETE CASCADE
);

-- Student_Subject relation
CREATE TABLE Student_Subject (
    Reg_no VARCHAR(12) NOT NULL,
    Sub_code VARCHAR(10) NOT NULL,
    Enroll_date DATE,
    PRIMARY KEY (Reg_no, Sub_code),
    FOREIGN KEY (Reg_no) REFERENCES Student(Reg_no)
        ON UPDATE CASCADE
        ON DELETE CASCADE,
    FOREIGN KEY (Sub_code) REFERENCES Subject(Sub_code)
        ON UPDATE CASCADE
        ON DELETE CASCADE
);

-- Guardians of Students
CREATE TABLE Guardian_for_stu (
    NIC VARCHAR(12) NOT NULL,
    Address VARCHAR(50),
    Gender ENUM('Male', 'Female') NOT NULL,
    Relationship VARCHAR(20),
    Rel_name VARCHAR(30) NOT NULL,
    Reg_no VARCHAR(12) NOT NULL,
    PRIMARY KEY (Reg_no, NIC),
    FOREIGN KEY (Reg_no) REFERENCES Student(Reg_no)
        ON UPDATE CASCADE
        ON DELETE CASCADE
);

-- Student_Guardian relation
CREATE TABLE Student_Guardian_dep (
    Reg_no VARCHAR(12) NOT NULL,
    NIC VARCHAR(12) NOT NULL,
    PRIMARY KEY (Reg_no, NIC),
    FOREIGN KEY (Reg_no) REFERENCES Student(Reg_no)
        ON UPDATE CASCADE
        ON DELETE CASCADE,
    FOREIGN KEY (NIC) REFERENCES Guardian_for_stu(NIC)
        ON UPDATE CASCADE
        ON DELETE CASCADE
);

-- Sports table
CREATE TABLE Sports (
    Sport_id VARCHAR(5) PRIMARY KEY,
    Sport_name VARCHAR(50) NOT NULL
);

-- Student_Sports relation
CREATE TABLE Student_Sports (
    Reg_no VARCHAR(12) NOT NULL,
    Sport_id VARCHAR(5) NOT NULL,
    Joined_date DATE,
    Position VARCHAR(30),
    PRIMARY KEY (Reg_no, Sport_id),
    FOREIGN KEY (Reg_no) REFERENCES Student(Reg_no)
        ON UPDATE CASCADE
        ON DELETE CASCADE,
    FOREIGN KEY (Sport_id) REFERENCES Sports(Sport_id)
        ON UPDATE CASCADE
        ON DELETE CASCADE
);
<<<<<<< HEAD
>>>>>>> TGl1714
>>>>>>> c423f58aec4132da74aec211d9551ff82c38a433
=======
>>>>>>> fad0389e71caab9d06ac1383292fed22c9276bfe



      CREATE TABLE Session(
             Sub_code VARCHAR(10),
			 Session_id VARCHAR(10),
			 Session_name VARCHAR(20),
			 Hour INT,
             Ses_date DATE,
			 TYPE ENUM('Theory','Absent'),
			 PRIMARY KEY(Sub_code, Session_id),
			 FOREIGN KEY(Sub_code) REFERENCES Subject(Sub_code)
			  ON DELETE CASCADE ON UPDATE CASCADE
			 );
			 
	
	CREATE TABLE Session_Student(
	        Sub_code VARCHAR(10),
			Session_id VARCHAR(10),
			Reg_no VARCHAR(12),
			Status ENUM('Present','Absent') DEFAULT 'Absent',
			PRIMARY KEY(Sub_code,Session_id,Reg_no),
			FOREIGN KEY(Sub_code, Session_id) REFERENCES Session(Sub_code, Session_id),
			FOREIGN KEY(Reg_no) REFERENCES Student(Reg_no)
<<<<<<< HEAD
			);
=======
			);




############################################### MARKS TABLE

CREATE TABLE Ma(Reg_no VARCHAR(12),
Sub_code VARCHAR(10),
Exam_code VARCHAR(10),
Mark FLOAT,
Type ENUM('Proper','Repeat') DEFAULT 'Proper',
PRIMARY KEY(Reg_no,Sub_code,Exam_code),
FOREIGN KEY(Reg_no) REFERENCES Student(Reg_no) ON DELETE CASCADE,
FOREIGN KEY(Sub_code) REFERENCES Subject(Sub_code) ON DELETE CASCADE,
FOREIGN KEY(Exam_code) REFERENCES Exam(Exam_code) ON DELETE CASCADE);


INSERT INTO Marks (Reg_no, Sub_code, Exam_code, Mark, Type) VALUES
('TG/2023/1774', 'ENG1222', 'AS', 75, 'Proper'),
('TG/2023/1774', 'ENG1222', 'ET', 85, 'Proper'),
('TG/2023/1774', 'ENG1222', 'MT', 65, 'Proper'),
('TG/2023/1774', 'ICT1212', 'AS', 80, 'Proper'),
('TG/2023/1774', 'ICT1212', 'ET', 90, 'Proper'),
('TG/2023/1774', 'ICT1212', 'MT', 95, 'Proper'),
('TG/2023/1774', 'ICT1212', 'Q1', 80, 'Proper'),
('TG/2023/1774', 'ICT1212', 'Q2', 80, 'Proper'),
('TG/2023/1774', 'ICT1212', 'Q3', 80, 'Proper'),
('TG/2023/1774', 'ICT1222', 'AS', 75, 'Proper'),
('TG/2023/1774', 'ICT1222', 'EP', 75, 'Proper'),
('TG/2023/1774', 'ICT1222', 'MP', 75, 'Proper'),
('TG/2023/1774', 'ICT1233', 'AS', 70, 'Proper'),
('TG/2023/1774', 'ICT1233', 'EP', 95, 'Proper'),
('TG/2023/1774', 'ICT1233', 'ET', 98, 'Proper'),
('TG/2023/1774', 'ICT1233', 'MP', 90, 'Proper'),
('TG/2023/1774', 'ICT1233', 'Q1', 100, 'Proper'),
('TG/2023/1774', 'ICT1233', 'Q2', 100, 'Proper'),
('TG/2023/1774', 'ICT1233', 'Q3', 60, 'Proper'),
('TG/2023/1774', 'ICT1242', 'AS', 80, 'Proper'),
('TG/2023/1774', 'ICT1242', 'ET', 85, 'Proper'),
('TG/2023/1774', 'ICT1242', 'MT', 80, 'Proper'),
('TG/2023/1774', 'ICT1242', 'Q1', 60, 'Proper'),
('TG/2023/1774', 'ICT1242', 'Q2', 80, 'Proper'),
('TG/2023/1774', 'ICT1242', 'Q3', 50, 'Proper'),
('TG/2023/1774', 'ICT1253', 'AS', 90, 'Proper'),
('TG/2023/1774', 'ICT1253', 'EP', 95, 'Proper'),
('TG/2023/1774', 'ICT1253', 'ET', 75, 'Proper'),
('TG/2023/1774', 'ICT1253', 'MP', 80, 'Proper'),
('TG/2023/1774', 'ICT1253', 'Q1', 80, 'Proper'),
('TG/2023/1774', 'ICT1253', 'Q2', 100, 'Proper'),
('TG/2023/1774', 'ICT1253', 'Q3', 100, 'Proper'),
('TG/2023/1774', 'TCS1212', 'AS', 90, 'Proper'),
('TG/2023/1774', 'TCS1212', 'Q1', 50, 'Proper'),
('TG/2023/1774', 'TCS1212', 'Q2', 100, 'Proper'),
('TG/2023/1775', 'ENG1222', 'AS', 65, 'Proper'),
('TG/2023/1775', 'ENG1222', 'ET', 78, 'Proper'),
('TG/2023/1775', 'ENG1222', 'MT', 79, 'Proper'),
('TG/2023/1775', 'ICT1212', 'AS', 62, 'Proper'),
('TG/2023/1775', 'ICT1212', 'ET', 92, 'Proper'),
('TG/2023/1775', 'ICT1212', 'MT', 75, 'Proper'),
('TG/2023/1775', 'ICT1212', 'Q1', 60, 'Proper'),
('TG/2023/1775', 'ICT1212', 'Q2', 60, 'Proper'),
('TG/2023/1775', 'ICT1212', 'Q3', 60, 'Proper'),
('TG/2023/1775', 'ICT1222', 'AS', 90, 'Proper'),
('TG/2023/1775', 'ICT1222', 'EP', 78, 'Proper'),
('TG/2023/1775', 'ICT1222', 'MP', 64, 'Proper'),
('TG/2023/1775', 'ICT1233', 'AS', 80, 'Proper'),
('TG/2023/1775', 'ICT1233', 'EP', 75, 'Proper'),
('TG/2023/1775', 'ICT1233', 'ET', 78, 'Proper'),
('TG/2023/1775', 'ICT1233', 'MP', 80, 'Proper'),
('TG/2023/1775', 'ICT1233', 'Q1', 60, 'Proper'),
('TG/2023/1775', 'ICT1233', 'Q2', 60, 'Proper'),
('TG/2023/1775', 'ICT1233', 'Q3', 70, 'Proper'),
('TG/2023/1775', 'ICT1242', 'AS', 70, 'Proper'),
('TG/2023/1775', 'ICT1242', 'ET', 80, 'Proper'),
('TG/2023/1775', 'ICT1242', 'MT', 85, 'Proper'),
('TG/2023/1775', 'ICT1242', 'Q1', 60, 'Proper'),
('TG/2023/1775', 'ICT1242', 'Q2', 100, 'Proper'),
('TG/2023/1775', 'ICT1242', 'Q3', 100, 'Proper'),
('TG/2023/1775', 'ICT1253', 'AS', 70, 'Proper'),
('TG/2023/1775', 'ICT1253', 'EP', 94, 'Proper'),
('TG/2023/1775', 'ICT1253', 'ET', 88, 'Proper'),
('TG/2023/1775', 'ICT1253', 'MP', 95, 'Proper'),
('TG/2023/1775', 'ICT1253', 'Q1', 100, 'Proper'),
('TG/2023/1775', 'ICT1253', 'Q2', 100, 'Proper'),
('TG/2023/1775', 'ICT1253', 'Q3', 80, 'Proper'),
('TG/2023/1775', 'TCS1212', 'AS', 85, 'Proper'),
('TG/2023/1775', 'TCS1212', 'Q1', 80, 'Proper'),
('TG/2023/1775', 'TCS1212', 'Q2', 90, 'Proper'),
('TG/2023/1776', 'ENG1222', 'AS', 75, 'Proper'),
('TG/2023/1776', 'ENG1222', 'ET', 88, 'Proper'),
('TG/2023/1776', 'ENG1222', 'MT', 69, 'Proper'),
('TG/2023/1776', 'ICT1212', 'AS', 78, 'Proper'),
('TG/2023/1776', 'ICT1212', 'ET', 95, 'Proper'),
('TG/2023/1776', 'ICT1212', 'MT', 80, 'Proper'),
('TG/2023/1776', 'ICT1212', 'Q1', 100, 'Proper'),
('TG/2023/1776', 'ICT1212', 'Q2', 100, 'Proper'),
('TG/2023/1776', 'ICT1212', 'Q3', 40, 'Proper'),
('TG/2023/1776', 'ICT1222', 'AS', 75, 'Proper'),
('TG/2023/1776', 'ICT1222', 'EP', 55, 'Proper'),
('TG/2023/1776', 'ICT1222', 'MP', 58, 'Proper'),
('TG/2023/1776', 'ICT1233', 'AS', 90, 'Proper'),
('TG/2023/1776', 'ICT1233', 'EP', 74, 'Proper'),
('TG/2023/1776', 'ICT1233', 'ET', 71, 'Proper'),
('TG/2023/1776', 'ICT1233', 'MP', 59, 'Proper'),
('TG/2023/1776', 'ICT1233', 'Q1', 62, 'Proper'),
('TG/2023/1776', 'ICT1233', 'Q2', 63, 'Proper'),
('TG/2023/1776', 'ICT1233', 'Q3', 00, 'Proper'),
('TG/2023/1776', 'ICT1242', 'AS', 50, 'Proper'),
('TG/2023/1776', 'ICT1242', 'ET', 56, 'Proper'),
('TG/2023/1776', 'ICT1242', 'MT', 46, 'Proper'),
('TG/2023/1776', 'ICT1242', 'Q1', 40, 'Proper'),
('TG/2023/1776', 'ICT1242', 'Q2', 50, 'Proper'),
('TG/2023/1776', 'ICT1242', 'Q3', 60, 'Proper'),
('TG/2023/1776', 'ICT1253', 'AS', 50, 'Proper'),
('TG/2023/1776', 'ICT1253', 'EP', 45, 'Proper'),
('TG/2023/1776', 'ICT1253', 'ET', 75, 'Proper'),
('TG/2023/1776', 'ICT1253', 'MP', 65, 'Proper'),
('TG/2023/1776', 'ICT1253', 'Q1', 100, 'Proper'),
('TG/2023/1776', 'ICT1253', 'Q2', 80, 'Proper'),
('TG/2023/1776', 'ICT1253', 'Q3', 60, 'Proper'),
('TG/2023/1776', 'TCS1212', 'AS', 70, 'Proper'),
('TG/2023/1776', 'TCS1212', 'Q1', 45, 'Proper'),
('TG/2023/1776', 'TCS1212', 'Q2', 40, 'Proper'),
('TG/2023/1777', 'ENG1222', 'AS', 100, 'Proper'),
('TG/2023/1777', 'ENG1222', 'ET', 53, 'Proper'),
('TG/2023/1777', 'ENG1222', 'MT', 100, 'Proper'),
('TG/2023/1777', 'ICT1212', 'AS', 75, 'Proper'),
('TG/2023/1777', 'ICT1212', 'ET', 75, 'Proper'),
('TG/2023/1777', 'ICT1212', 'MT', 75, 'Proper'),
('TG/2023/1777', 'ICT1212', 'Q1', 50, 'Proper'),
('TG/2023/1777', 'ICT1212', 'Q2', 100, 'Proper'),
('TG/2023/1777', 'ICT1212', 'Q3', 70, 'Proper'),
('TG/2023/1777', 'ICT1222', 'AS', 98, 'Proper'),
('TG/2023/1777', 'ICT1222', 'EP', 65, 'Proper'),
('TG/2023/1777', 'ICT1222', 'MP', 70, 'Proper'),
('TG/2023/1777', 'ICT1233', 'AS', 100, 'Proper'),
('TG/2023/1777', 'ICT1233', 'EP', 60, 'Proper'),
('TG/2023/1777', 'ICT1233', 'ET', 70, 'Proper'),
('TG/2023/1777', 'ICT1233', 'MP', 90, 'Proper'),
('TG/2023/1777', 'ICT1233', 'Q1', 30, 'Proper'),
('TG/2023/1777', 'ICT1233', 'Q2', 80, 'Proper'),
('TG/2023/1777', 'ICT1233', 'Q3', 95, 'Proper'),
('TG/2023/1777', 'ICT1242', 'AS', 70, 'Proper'),
('TG/2023/1777', 'ICT1242', 'ET', 88, 'Proper'),
('TG/2023/1777', 'ICT1242', 'MT', 63, 'Proper'),
('TG/2023/1777', 'ICT1242', 'Q1', 75, 'Proper'),
('TG/2023/1777', 'ICT1242', 'Q2', 100, 'Proper'),
('TG/2023/1777', 'ICT1242', 'Q3',65 , 'Proper'),
('TG/2023/1777', 'ICT1253', 'AS', 82, 'Proper'),
('TG/2023/1777', 'ICT1253', 'EP', 28, 'Proper'),
('TG/2023/1777', 'ICT1253', 'ET', 64, 'Proper'),
('TG/2023/1777', 'ICT1253', 'MP', 72, 'Proper'),
('TG/2023/1777', 'ICT1253', 'Q1', 59, 'Proper'),
('TG/2023/1777', 'ICT1253', 'Q2', 66, 'Proper'),
('TG/2023/1777', 'ICT1253', 'Q3', 30, 'Proper'),
('TG/2023/1777', 'TCS1212', 'AS', 74, 'Proper'),
('TG/2023/1777', 'TCS1212', 'Q1', 62, 'Proper'),
('TG/2023/1777', 'TCS1212', 'Q2', 81, 'Proper'),
('TG/2023/1778', 'ENG1222', 'AS', 65, 'Proper'),
('TG/2023/1778', 'ENG1222', 'ET', 31, 'Proper'),
('TG/2023/1778', 'ENG1222', 'MT', 55, 'Proper'),
('TG/2023/1778', 'ICT1212', 'AS', 85, 'Proper'),
('TG/2023/1778', 'ICT1212', 'ET', 76, 'Proper'),
('TG/2023/1778', 'ICT1212', 'MT', 69, 'Proper'),
('TG/2023/1778', 'ICT1212', 'Q1', 32, 'Proper'),
('TG/2023/1778', 'ICT1212', 'Q2', 73, 'Proper'),
('TG/2023/1778', 'ICT1212', 'Q3', 61, 'Proper'),
('TG/2023/1778', 'ICT1222', 'AS', 64, 'Proper'),
('TG/2023/1778', 'ICT1222', 'EP', 80, 'Proper'),
('TG/2023/1778', 'ICT1222', 'MP', 79, 'Proper'),
('TG/2023/1778', 'ICT1233', 'AS', 88, 'Proper'),
('TG/2023/1778', 'ICT1233', 'EP', 67, 'Proper'),
('TG/2023/1778', 'ICT1233', 'ET', 29, 'Proper'),
('TG/2023/1778', 'ICT1233', 'MP', 70, 'Proper'),
('TG/2023/1778', 'ICT1233', 'Q1', 59, 'Proper'),
('TG/2023/1778', 'ICT1233', 'Q2', 74, 'Proper'),
('TG/2023/1778', 'ICT1233', 'Q3', 33, 'Proper'),
('TG/2023/1778', 'ICT1242', 'AS', 71, 'Proper'),
('TG/2023/1778', 'ICT1242', 'ET', 54, 'Proper'),
('TG/2023/1778', 'ICT1242', 'MT', 77, 'Proper'),
('TG/2023/1778', 'ICT1242', 'Q1', 67, 'Proper'),
('TG/2023/1778', 'ICT1242', 'Q2', 28, 'Proper'),
('TG/2023/1778', 'ICT1242', 'Q3', 74, 'Proper'),
('TG/2023/1778', 'ICT1253', 'AS', 65, 'Proper'),
('TG/2023/1778', 'ICT1253', 'EP', 80, 'Proper'),
('TG/2023/1778', 'ICT1253', 'ET', 71, 'Proper'),
('TG/2023/1778', 'ICT1253', 'MP', 31, 'Proper'),
('TG/2023/1778', 'ICT1253', 'Q1', 66, 'Proper'),
('TG/2023/1778', 'ICT1253', 'Q2', 74, 'Proper'),
('TG/2023/1778', 'ICT1253', 'Q3', 79, 'Proper'),
('TG/2023/1778', 'TCS1212', 'AS', 73, 'Proper'),
('TG/2023/1778', 'TCS1212', 'Q1', 27, 'Proper'),
('TG/2023/1778', 'TCS1212', 'Q2', 65, 'Proper'),
('TG/2023/1779', 'ENG1222', 'AS', 68, 'Proper'),
('TG/2023/1779', 'ENG1222', 'ET', 74, 'Proper'),
('TG/2023/1779', 'ENG1222', 'MT', 63, 'Proper'),
('TG/2023/1779', 'ICT1212', 'AS', 24, 'Proper'),
('TG/2023/1779', 'ICT1212', 'ET', 77, 'Proper'),
('TG/2023/1779', 'ICT1212', 'MT', 34, 'Proper'),
('TG/2023/1779', 'ICT1212', 'Q1', 59, 'Proper'),
('TG/2023/1779', 'ICT1212', 'Q2', 69, 'Proper'),
('TG/2023/1779', 'ICT1212', 'Q3', 71, 'Proper'),
('TG/2023/1779', 'ICT1222', 'AS', 75, 'Proper'),
('TG/2023/1779', 'ICT1222', 'EP', 29, 'Proper'),
('TG/2023/1779', 'ICT1222', 'MP', 68, 'Proper'),
('TG/2023/1779', 'ICT1233', 'AS', 80, 'Proper'),
('TG/2023/1779', 'ICT1233', 'EP', 61, 'Proper'),
('TG/2023/1779', 'ICT1233', 'ET', 30, 'Proper'),
('TG/2023/1779', 'ICT1233', 'MP', 78, 'Proper'),
('TG/2023/1779', 'ICT1233', 'Q1', 62, 'Proper'),
('TG/2023/1779', 'ICT1233', 'Q2', 69, 'Proper'),
('TG/2023/1779', 'ICT1233', 'Q3', 31, 'Proper'),
('TG/2023/1779', 'ICT1242', 'AS', 77, 'Proper'),
('TG/2023/1779', 'ICT1242', 'ET', 65, 'Proper'),
('TG/2023/1779', 'ICT1242', 'MT', 53, 'Proper'),
('TG/2023/1779', 'ICT1242', 'Q1', 35, 'Proper'),
('TG/2023/1779', 'ICT1242', 'Q2', 68, 'Proper'),
('TG/2023/1779', 'ICT1242', 'Q3', 74, 'Proper'),
('TG/2023/1779', 'ICT1253', 'AS', 69, 'Proper'),
('TG/2023/1779', 'ICT1253', 'EP', 63, 'Proper'),
('TG/2023/1779', 'ICT1253', 'ET', 26, 'Proper'),
('TG/2023/1779', 'ICT1253', 'MP', 70, 'Proper'),
('TG/2023/1779', 'ICT1253', 'Q1', 67, 'Proper'),
('TG/2023/1779', 'ICT1253', 'Q2', 72, 'Proper'),
('TG/2023/1779', 'ICT1253', 'Q3', 29, 'Proper'),
('TG/2023/1779', 'TCS1212', 'AS', 79, 'Proper'),
('TG/2023/1779', 'TCS1212', 'Q1', 62, 'Proper'),
('TG/2023/1779', 'TCS1212', 'Q2', 34, 'Proper'),
('TG/2023/1780', 'ENG1222', 'AS', 74, 'Proper'),
('TG/2023/1780', 'ENG1222', 'ET', 65, 'Proper'),
('TG/2023/1780', 'ENG1222', 'MT', 29, 'Proper'),
('TG/2023/1780', 'ICT1212', 'AS', 71, 'Proper'),
('TG/2023/1780', 'ICT1212', 'ET', 82, 'Proper'),
('TG/2023/1780', 'ICT1212', 'MT', 66, 'Proper'),
('TG/2023/1780', 'ICT1212', 'Q1', 57, 'Proper'),
('TG/2023/1780', 'ICT1212', 'Q2', 33, 'Proper'),
('TG/2023/1780', 'ICT1212', 'Q3', 72, 'Proper'),
('TG/2023/1780', 'ICT1222', 'AS', 64, 'Proper'),
('TG/2023/1780', 'ICT1222', 'EP', 79, 'Proper'),
('TG/2023/1780', 'ICT1222', 'MP', 25, 'Proper'),
('TG/2023/1780', 'ICT1233', 'AS', 73, 'Proper'),
('TG/2023/1780', 'ICT1233', 'EP', 61, 'Proper'),
('TG/2023/1780', 'ICT1233', 'ET', 78, 'Proper'),
('TG/2023/1780', 'ICT1233', 'MP', 65, 'Proper'),
('TG/2023/1780', 'ICT1233', 'Q1', 31, 'Proper'),
('TG/2023/1780', 'ICT1233', 'Q2', 68, 'Proper'),
('TG/2023/1780', 'ICT1233', 'Q3', 80, 'Proper'),
('TG/2023/1780', 'ICT1242', 'AS', 83, 'Proper'),
('TG/2023/1780', 'ICT1242', 'ET', 70, 'Proper'),
('TG/2023/1780', 'ICT1242', 'MT', 28, 'Proper'),
('TG/2023/1780', 'ICT1242', 'Q1', 66, 'Proper'),
('TG/2023/1780', 'ICT1242', 'Q2', 61, 'Proper'),
('TG/2023/1780', 'ICT1242', 'Q3', 63, 'Proper'),
('TG/2023/1780', 'ICT1253', 'AS', 77, 'Proper'),
('TG/2023/1780', 'ICT1253', 'EP', 63, 'Proper'),
('TG/2023/1780', 'ICT1253', 'ET', 72, 'Proper'),
('TG/2023/1780', 'ICT1253', 'MP', 68, 'Proper'),
('TG/2023/1780', 'ICT1253', 'Q1', 24, 'Proper'),
('TG/2023/1780', 'ICT1253', 'Q2', 78, 'Proper'),
('TG/2023/1780', 'ICT1253', 'Q3', 62, 'Proper'),
('TG/2023/1780', 'TCS1212', 'AS', 84, 'Proper'),
('TG/2023/1780', 'TCS1212', 'Q1', 31, 'Proper'),
('TG/2023/1780', 'TCS1212', 'Q2', 70, 'Proper'),
('TG/2023/1781', 'ENG1222', 'AS', 62, 'Proper'),
('TG/2023/1781', 'ENG1222', 'ET', 69, 'Proper'),
('TG/2023/1781', 'ENG1222', 'MT', 33, 'Proper'),
('TG/2023/1781', 'ICT1212', 'AS', 70, 'Proper'),
('TG/2023/1781', 'ICT1212', 'ET', 77, 'Proper'),
('TG/2023/1781', 'ICT1212', 'MT', 66, 'Proper'),
('TG/2023/1781', 'ICT1212', 'Q1', 74, 'Proper'),
('TG/2023/1781', 'ICT1212', 'Q2', 30, 'Proper'),
('TG/2023/1781', 'ICT1212', 'Q3', 82, 'Proper'),
('TG/2023/1781', 'ICT1222', 'AS', 63, 'Proper'),
('TG/2023/1781', 'ICT1222', 'EP', 80, 'Proper'),
('TG/2023/1781', 'ICT1222', 'MP', 59, 'Proper'),
('TG/2023/1781', 'ICT1233', 'AS', 67, 'Proper'),
('TG/2023/1781', 'ICT1233', 'EP', 28, 'Proper'),
('TG/2023/1781', 'ICT1233', 'ET', 73, 'Proper'),
('TG/2023/1781', 'ICT1233', 'MP', 61, 'Proper'),
('TG/2023/1781', 'ICT1233', 'Q1', 63, 'Proper'),
('TG/2023/1781', 'ICT1233', 'Q2', 71, 'Proper'),
('TG/2023/1781', 'ICT1233', 'Q3', 29, 'Proper'),
('TG/2023/1781', 'ICT1242', 'AS', 75, 'Proper'),
('TG/2023/1781', 'ICT1242', 'ET', 68, 'Proper'),
('TG/2023/1781', 'ICT1242', 'MT', 54, 'Proper'),
('TG/2023/1781', 'ICT1242', 'Q1', 66, 'Proper'),
('TG/2023/1781', 'ICT1242', 'Q2', 25, 'Proper'),
('TG/2023/1781', 'ICT1242', 'Q3', 70, 'Proper'),
('TG/2023/1781', 'ICT1253', 'AS', 72, 'Proper'),
('TG/2023/1781', 'ICT1253', 'EP', 61, 'Proper'),
('TG/2023/1781', 'ICT1253', 'ET', 68, 'Proper'),
('TG/2023/1781', 'ICT1253', 'MP', 29, 'Proper'),
('TG/2023/1781', 'ICT1253', 'Q1', 78, 'Proper'),
('TG/2023/1781', 'ICT1253', 'Q2', 63, 'Proper'),
('TG/2023/1781', 'ICT1253', 'Q3', 65, 'Proper'),
('TG/2023/1781', 'TCS1212', 'AS', 83, 'Proper'),
('TG/2023/1781', 'TCS1212', 'Q1', 33, 'Proper'),
('TG/2023/1781', 'TCS1212', 'Q2', 76, 'Proper'),
('TG/2023/1782', 'ENG1222', 'AS', 78, 'Proper'),
('TG/2023/1782', 'ENG1222', 'ET', 73, 'Proper'),
('TG/2023/1782', 'ENG1222', 'MT', 34, 'Proper'),
('TG/2023/1782', 'ICT1212', 'AS', 69, 'Proper'),
('TG/2023/1782', 'ICT1212', 'ET', 65, 'Proper'),
('TG/2023/1782', 'ICT1212', 'MT', 72, 'Proper'),
('TG/2023/1782', 'ICT1212', 'Q1', 63, 'Proper'),
('TG/2023/1782', 'ICT1212', 'Q2', 29, 'Proper'),
('TG/2023/1782', 'ICT1212', 'Q3', 66, 'Proper'),
('TG/2023/1782', 'ICT1222', 'AS', 61, 'Proper'),
('TG/2023/1782', 'ICT1222', 'EP', 68, 'Proper'),
('TG/2023/1782', 'ICT1222', 'MP', 31, 'Proper'),
('TG/2023/1782', 'ICT1233', 'AS', 76, 'Proper'),
('TG/2023/1782', 'ICT1233', 'EP', 71, 'Proper'),
('TG/2023/1782', 'ICT1233', 'ET', 27, 'Proper'),
('TG/2023/1782', 'ICT1233', 'MP', 64, 'Proper'),
('TG/2023/1782', 'ICT1233', 'Q1', 79, 'Proper'),
('TG/2023/1782', 'ICT1233', 'Q2', 62, 'Proper'),
('TG/2023/1782', 'ICT1233', 'Q3', 28, 'Proper'),
('TG/2023/1782', 'ICT1242', 'AS', 70, 'Proper'),
('TG/2023/1782', 'ICT1242', 'ET', 59, 'Proper'),
('TG/2023/1782', 'ICT1242', 'MT', 33, 'Proper'),
('TG/2023/1782', 'ICT1242', 'Q1', 74, 'Proper'),
('TG/2023/1782', 'ICT1242', 'Q2', 67, 'Proper'),
('TG/2023/1782', 'ICT1242', 'Q3', 72, 'Proper'),
('TG/2023/1782', 'ICT1253', 'AS', 80, 'Proper'),
('TG/2023/1782', 'ICT1253', 'EP', 65, 'Proper'),
('TG/2023/1782', 'ICT1253', 'ET', 31, 'Proper'),
('TG/2023/1782', 'ICT1253', 'MP', 73, 'Proper'),
('TG/2023/1782', 'ICT1253', 'Q1', 61, 'Proper'),
('TG/2023/1782', 'ICT1253', 'Q2', 30, 'Proper'),
('TG/2023/1782', 'ICT1253', 'Q3', 79, 'Proper'),
('TG/2023/1782', 'TCS1212', 'AS', 84, 'Proper'),
('TG/2023/1782', 'TCS1212', 'Q1', 62, 'Proper'),
('TG/2023/1782', 'TCS1212', 'Q2', 26, 'Proper'),
('TG/2023/1783', 'ENG1222', 'AS', 73, 'Proper'),
('TG/2023/1783', 'ENG1222', 'ET', 79, 'Proper'),
('TG/2023/1783', 'ENG1222', 'MT', 32, 'Proper'),
('TG/2023/1783', 'ICT1212', 'AS', 80, 'Proper'),
('TG/2023/1783', 'ICT1212', 'ET', 70, 'Proper'),
('TG/2023/1783', 'ICT1212', 'MT', 74, 'Proper'),
('TG/2023/1783', 'ICT1212', 'Q1', 31, 'Proper'),
('TG/2023/1783', 'ICT1212', 'Q2', 77, 'Proper'),
('TG/2023/1783', 'ICT1212', 'Q3', 69, 'Proper'),
('TG/2023/1783', 'ICT1222', 'AS', 72, 'Proper'),
('TG/2023/1783', 'ICT1222', 'EP', 63, 'Proper'),
('TG/2023/1783', 'ICT1222', 'MP', 33, 'Proper'),
('TG/2023/1783', 'ICT1233', 'AS', 64, 'Proper'),
('TG/2023/1783', 'ICT1233', 'EP', 76, 'Proper'),
('TG/2023/1783', 'ICT1233', 'ET', 71, 'Proper'),
('TG/2023/1783', 'ICT1233', 'MP', 24, 'Proper'),
('TG/2023/1783', 'ICT1233', 'Q1', 78, 'Proper'),
('TG/2023/1783', 'ICT1233', 'Q2', 64, 'Proper'),
('TG/2023/1783', 'ICT1233', 'Q3', 29, 'Proper'),
('TG/2023/1783', 'ICT1242', 'AS', 83, 'Proper'),
('TG/2023/1783', 'ICT1242', 'ET', 62, 'Proper'),
('TG/2023/1783', 'ICT1242', 'MT', 67, 'Proper'),
('TG/2023/1783', 'ICT1242', 'Q1', 71, 'Proper'),
('TG/2023/1783', 'ICT1242', 'Q2', 28, 'Proper'),
('TG/2023/1783', 'ICT1242', 'Q3', 74, 'Proper'),
('TG/2023/1783', 'ICT1253', 'AS', 70, 'Proper'),
('TG/2023/1783', 'ICT1253', 'EP', 73, 'Proper'),
('TG/2023/1783', 'ICT1253', 'ET', 75, 'Proper'),
('TG/2023/1783', 'ICT1253', 'MP', 63, 'Proper'),
('TG/2023/1783', 'ICT1253', 'Q1', 60, 'Proper'),
('TG/2023/1783', 'ICT1253', 'Q2', 27, 'Proper'),
('TG/2023/1783', 'ICT1253', 'Q3', 80, 'Proper'),
('TG/2023/1783', 'TCS1212', 'AS', 84, 'Proper'),
('TG/2023/1783', 'TCS1212', 'Q1', 67, 'Proper'),
('TG/2023/1783', 'TCS1212', 'Q2', 30, 'Proper'),
('TG/2021/1456','TCS1233','ET',85,'Repeat'),
('TG/2021/1452','TCS1233','ET',65,'Repeat'),
('TG/2021/1453','TCS1233','ET',55,'Repeat'),
('TG/2021/1454','TCS1212','ET',55,'Repeat'),
('TG/2021/1455','TCS1233','Q1',100,'Repeat'),
('TG/2021/1455','TCS1233','Q2',60,'Repeat'),
('TG/2021/1455','TCS1233','MT',75,'Repeat'),
('TG/2021/1456','ICT1242','ET',80,'Repeat');








CREATE OR REPLACE VIEW Attendance_batch  AS
    SELECT
    ss.Reg_no,
    ss.Sub_code,
    subj.Sub_name,
    SUM(CASE 
            WHEN ss.Status='Present' THEN s.Hour
            WHEN ss.Status='Absent' AND m.Status='Approved' s.Hour
            ELSE 0
        END) AS Attended_Hours,
    subj.Total_hours AS Total_Course_Hours,
    ROUND(
        (SUM(CASE 
                WHEN ss.Status='Present' THEN s.Hour
                WHEN ss.Status='Absent' AND m.Status='Approved' THEN s.Hour
                ELSE 0
            END) / subj.Total_hours) * 100, 2
    ) AS Attendance_Percentage,
    CASE
        WHEN ROUND(
            (SUM(CASE 
                    WHEN ss.Status='Present' THEN s.Hour
                    WHEN ss.Status='Absent' AND m.Status='Approved' THEN s.Hour
                    ELSE 0
                END) / subj.Total_hours) * 100, 2
        ) >= 80 THEN 'Eligible'
        ELSE 'Not Eligible'
    END AS Eligibility
FROM Session_Student ss
JOIN Session s
    ON ss.Sub_code = s.Sub_code AND ss.Session_id = s.Session_id
JOIN Subject subj
    ON ss.Sub_code = subj.Sub_code
LEFT JOIN Medical m
    ON ss.Reg_no = m.Reg_no AND s.Ses_date = m.Date_issued
GROUP BY ss.Reg_no, ss.Sub_code
ORDER BY ss.Sub_code, ss.Reg_no;



CREATE PROCEDURE Attendance_indivitual(IN p_reg_no VARCHAR(10))
BEGIN  
  SELECT * FROM Attendance_batch
	WHERE Reg_no=p_reg_no;
   END//
 




 
  CREATE PROCEDURE Attendance_By_cource(IN p_sub_code VARCHAR(10))
BEGIN  
  SELECT *
  FROM Attendance_batch
	WHERE Sub_code=p_sub_code;
   END//
   
   
   
   
   DELIMITER //









  
>>>>>>> fad0389e71caab9d06ac1383292fed22c9276bfe
